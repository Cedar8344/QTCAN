ÿÿo"key"§00D15000000EFfI0DB1C000000GnMR0051C000008D1GTen_UScb3a5bbc-d1c2-490d-ab7a-be367594452cBLM15344862980000000000000049.0:markup://runtime_sales_pipelineboard:pipelineView"itemo"value"ÞÎ{"xs":"I","descriptor":"markup://runtime_sales_pipelineboard:pipelineView","st":{"descriptor":"css://runtime_sales_pipelineboard.pipelineView","co":".runtime_sales_pipelineboardPipelineView .wrapperContainer{flex-wrap:wrap;display:flex;align-items:flex-start;align-content:flex-start;white-space:nowrap;overflow-x:hidden;padding-left:.5rem;padding-right:.5rem}.runtime_sales_pipelineboardPipelineView .recordTypeTabSetContainer~.container,.runtime_sales_pipelineboardPipelineView .recordTypeTabSetContainer~.maskContainer{margin-top:50px}.runtime_sales_pipelineboardPipelineView .container,.runtime_sales_pipelineboardPipelineView .maskContainer{position:absolute;top:0;right:0;bottom:0;left:0;margin-top:.5rem}.runtime_sales_pipelineboardPipelineView .hidden{display:none}.runtime_sales_pipelineboardPipelineView .dndAccessibilityMenu .uiMenuItem a{height:auto;padding:.5rem}.runtime_sales_pipelineboardPipelineView .uiDraggable.disabled{background-color:rgb(242, 242, 243);opacity:.5;-webkit-user-drag:none;transition:all .1s ease-in-out}.runtime_sales_pipelineboardPipelineView .container{display:flex;align-items:flex-start;align-content:flex-start;overflow-x:auto;padding-left:.5rem;padding-right:.5rem}.runtime_sales_pipelineboardPipelineView .container>div{position:relative}.runtime_sales_pipelineboardPipelineView .container .pipelineColumn{flex:1;min-width:14.5em;max-width:22.5em}.runtime_sales_pipelineboardPipelineView .container .pipelineHeader:before{content:\"\";position:absolute;left:-1rem;top:.19rem;display:block;width:1.85rem;height:1.85rem;border:2px solid #fff;border-left:none;border-bottom:none;transform:rotate(45deg)}.runtime_sales_pipelineboardPipelineView .container .pipelineColumn:first-of-type .pipelineHeader{border-radius:15rem 0 0 15rem}.runtime_sales_pipelineboardPipelineView .container .pipelineColumn:first-of-type .pipelineHeader:before{content:none}.runtime_sales_pipelineboardPipelineView .container .pipelineColumn:last-of-type .pipelineHeader{border-radius:0 15rem 15rem 0}.runtime_sales_pipelineboardPipelineView .container .pipelineColumn:last-of-type .pipelineAggregateHeader,.runtime_sales_pipelineboardPipelineView .container .pipelineColumn:last-of-type .listContent{border-right:rgb(212, 213, 218) 1px solid}.runtime_sales_pipelineboardPipelineView .container .pipelineColumn .pipelineAggregateHeader{height:3.5rem;line-height:2.5rem}.runtime_sales_pipelineboardPipelineView .container .pipelineColumn .pipelineAggregateHeader.small{font-size:1.25rem}.runtime_sales_pipelineboardPipelineView .container .pipelineColumn .pipelineAggregateHeader.xsmall{font-size:1rem}.runtime_sales_pipelineboardPipelineView .container ul{padding:0;margin:0}.runtime_sales_pipelineboardPipelineView .maskContainer>*{height:100%;width:100%;position:absolute;top:0}.runtime_sales_pipelineboardPipelineView .maskContainer .loadingStencil{background-color:rgb(255, 255, 255);margin-top:.5rem}.runtime_sales_pipelineboardPipelineView .maskContainer .loadingStencil.ease-in{display:block;transition:all .2s ease-in-out}.runtime_sales_pipelineboardPipelineView .maskContainer .loadingStencil.ease-out{display:none;transition:all .2s ease-in-out}.runtime_sales_pipelineboardPipelineView .maskContainer .pipelineViewMessage:not(.hidden){display:flex;flex-direction:column;align-items:center;justify-content:center}.runtime_sales_pipelineboardPipelineView .maskContainer .pipelineViewMessage .pipelineViewMessageContainer{background-color:rgb(255, 255, 255);padding:1rem;text-align:center}","cl":"runtime_sales_pipelineboardPipelineView"},"cd":{"descriptor":"compound://runtime_sales_pipelineboard.pipelineView","ac":[{"n":"getStageDependencyMap","descriptor":"serviceComponent://ui.pipelineboard.runtime.components.controller.PipelineViewRecordController/ACTION$getStageDependencyMap","at":"SERVER","rt":"java://java.util.Map","pa":[{"name":"recordTypeId","type":"java://java.lang.String"}]},{"n":"getPathAssistantAndAnimationRule","descriptor":"serviceComponent://ui.pipelineboard.runtime.components.controller.PipelineViewRecordController/ACTION$getPathAssistantAndAnimationRule","at":"SERVER","rt":"java://ui.pathassistant.runtime.api.models.PathAssistant","pa":[{"name":"entityName","type":"java://java.lang.String"},{"name":"groupByField","type":"java://java.lang.String"},{"name":"recordTypeId","type":"java://java.lang.String"}]},{"n":"refreshRecord","descriptor":"serviceComponent://ui.pipelineboard.runtime.components.controller.PipelineViewRecordController/ACTION$refreshRecord","at":"SERVER","rt":"java://ui.pipelineboard.runtime.api.models.PipelineDataRecord","pa":[{"name":"record","type":"java://ui.services.connection.models.api.Record"},{"name":"fields","type":"java://java.util.List<java.lang.String>"},{"name":"recordTypeId","type":"java://java.lang.String"},{"name":"listViewId","type":"java://java.lang.String"}]},{"n":"saveRecord","descriptor":"serviceComponent://ui.pipelineboard.runtime.components.controller.PipelineViewRecordController/ACTION$saveRecord","at":"SERVER","rt":"java://ui.pipelineboard.runtime.api.models.PipelineDataRecord","pa":[{"name":"record","type":"java://ui.services.connection.models.api.Record"},{"name":"fields","type":"java://java.util.List<java.lang.String>"},{"name":"recordTypeId","type":"java://java.lang.String"},{"name":"listViewId","type":"java://java.lang.String"},{"name":"allData","type":"java://java.util.Map<java.lang.String,java.util.LinkedHashMap<java.lang.String,java.lang.Object>>"}]}]},"ad":[["body","aura://Aura.Component[]","G",false,[]],["scope","aura://String","I",false],["scopeIcon","aura://String","I",false],["scopeColor","aura://String","I",false],["scopeLabel","aura://String","I",false],["scopeLabelSingular","aura://String","I",false],["entityName","aura://String","I",false],["filterName","aura://String","I",false],["filterTitle","aura://String","I",false],["searchString","aura://String","I",false],["itemVar","aura://String","I",false,"item"],["recordExpression","aura://String","I",false,"record"],["actionsExpression","aura://String","I",false,"actionsData"],["_allData","aura://Object","p",false,null],["_entityLabel","aura://String","I",false],["_entityLabelPlural","aura://String","I",false],["_listTemplate","aura://Aura.Component[]","p",false,[]],["_itemTemplate","aura://Aura.Component[]","p",false,[]],["_columnItems","aura://List","p",false,[]],["_closeLostColumnId","aura://String","p",false],["_closeLostMasterLabel","aura://String","p",false],["_closeLostHasPopup","aura://Boolean","p",false],["_dndAccessibilityContext","aura://String","p",false],["_dataProvider","aura://Aura.Component[]","p",false,[]],["_totalRecordCount","aura://Integer","p",false],["_aggregateValueFormat","aura://String","p",false],["_fields","aura://List","p",false,[]],["_groupByFieldName","aura://String","I",false],["_groupByFieldLabel","aura://String","I",false],["_groupByFieldType","aura://String","p",false],["_logInfo","aura://Map","p",false,null],["_recordTypeId","aura://String","p",false],["_recordData","aura://Object","p",false,null],["messages","aura://String[]","p",false,[]],["_stageDependencyMap","aura://Object","p",false,null],["_showCelebration","aura://Boolean","p",false,true],["_isPathAssistantMetadataLoading","aura://Boolean","p",false,false],["_isInitialLoading","aura://Boolean","p",false,true],["changeOwnerPanel","aura://Aura.Component","I",false,null],["changeOwnerWasClicked","aura://Boolean","I",false]],"med":[{"name":"runtime_sales_pipelineboard:reload","xs":"I","action":"{!c.handleReload}","attributes":[["forceReload","aura://Boolean","I",false],["showCachedDataIfPresent","aura://Boolean","I",false]]},{"name":"runtime_sales_pipelineboard:getSelectedRecordId","xs":"I","action":"{!c.getSelectedRecordId}"}],"i":["markup://forceSearch:scopeable","markup://force:recordListInterface"],"re":[{"ed":"markup://runtime_sales_pipelineboard:pipelineViewStateChangeEvent","n":"pipelineViewStateChange","xs":"I"},{"ed":"markup://runtime_sales_pipelineboard:pipelineViewRenderedEvent","n":"pipelineViewRenderedEvent","xs":"I"},{"ed":"markup://ui:change","n":"listChangeComplete","xs":"I"},{"ed":"markup://force:listViewManagerConfirmIfEdited","n":"confirmIfEdited","xs":"I"},{"ed":"markup://runtime_sales_pipelineboard:pipelineViewScrollEvent","n":"onLoadMoreData","xs":"I"},{"ed":"markup://force:showAppMessage","n":"showAppMessage","xs":"I"},{"ed":"markup://force:listViewManagerSecondaryDisplayChange","n":"secondaryDisplayChange","xs":"I"}],"hd":[{"x":{"exprType":"PROPERTY","byValue":false,"path":"c.init"},"v":{"exprType":"PROPERTY","byValue":false,"path":"this"},"n":"init"},{"x":{"exprType":"PROPERTY","byValue":false,"path":"c.handleValueChange"},"v":{"exprType":"PROPERTY","byValue":false,"path":"v._totalRecordCount"},"n":"change"},{"x":{"exprType":"PROPERTY","byValue":false,"path":"c.init"},"v":{"exprType":"PROPERTY","byValue":false,"path":"v.scope"},"n":"change"},{"ed":{"descriptor":"markup://runtime_sales_pipelineboard:pipelineViewRenderedEvent"},"x":{"exprType":"PROPERTY","byValue":false,"path":"c.onPipelineViewRendered"},"n":"pipelineViewRenderedEvent"},{"ed":{"descriptor":"markup://ui:notify"},"x":{"exprType":"PROPERTY","byValue":false,"path":"c.handleNotify"},"n":"notify"},{"ed":{"descriptor":"markup://forceChatter:postCreated"},"x":{"exprType":"PROPERTY","byValue":false,"path":"c.handlePostCreated"}},{"ed":{"descriptor":"markup://force:afterRecordSave"},"x":{"exprType":"PROPERTY","byValue":false,"path":"c.handleActionPerformed"}},{"ed":{"descriptor":"markup://force:recordDeleted"},"x":{"exprType":"PROPERTY","byValue":false,"path":"c.handleActionPerformed"}},{"ed":{"descriptor":"markup://ui:tabsetEvent"},"x":{"exprType":"PROPERTY","byValue":false,"path":"c.handleMultipleRecordTypeTabBeforeActivate"},"n":"beforeActivate"},{"ed":{"descriptor":"markup://ui:tabsetEvent"},"x":{"exprType":"PROPERTY","byValue":false,"path":"c.handleMultipleRecordTypeTabActivated"},"n":"onActivated"},{"ed":{"descriptor":"markup://runtime_sales_pipelineboard:pipelineViewScrollEvent"},"x":{"exprType":"PROPERTY","byValue":false,"path":"c.handleLoadMoreCards"},"n":"onLoadMoreData"},{"ed":{"descriptor":"markup://force:animationEvent"},"x":{"exprType":"PROPERTY","byValue":false,"path":"c.resizeAggregateValue"},"n":"onOutputNumberAnimationComplete"}],"ld":{"closeLostTarget":{"alias":"close-lost-target"}},"fa":[{"descriptor":"body","value":[{"componentDef":{"descriptor":"markup://force:userAssistancePopoversManager"},"localId":"userAssistancePopoversManager"},{"componentDef":{"descriptor":"markup://aura:html"},"attributes":{"values":{"HTMLAttributes":{"descriptor":"HTMLAttributes","value":{}},"tag":{"descriptor":"tag","value":"div"},"body":{"descriptor":"body","value":[{"componentDef":{"descriptor":"markup://aura:if"},"attributes":{"values":{"isTrue":{"descriptor":"isTrue","value":{"exprType":"FUNCTION","code":"function(cmp,fn){return (cmp.get(\"v._closeLostColumnId.length\")>0);}","args":[{"exprType":"PROPERTY","byValue":false,"target":"runtime_sales_pipelineboard:pipelineView","path":"v._closeLostColumnId.length"}],"byValue":false}},"body":{"descriptor":"body","value":[{"componentDef":{"descriptor":"markup://runtime_sales_pipelineboard:pipelineViewCloseLostTarget"},"localId":"closeLostTarget","attributes":{"values":{"ariaHasPopup":{"descriptor":"ariaHasPopup","value":{"exprType":"PROPERTY","byValue":false,"target":"runtime_sales_pipelineboard:pipelineView","path":"v._closeLostHasPopup"}},"label":{"descriptor":"label","value":{"exprType":"PROPERTY","byValue":false,"target":"runtime_sales_pipelineboard:pipelineView","path":"v._closeLostMasterLabel"}},"columnId":{"descriptor":"columnId","value":{"exprType":"PROPERTY","byValue":false,"target":"runtime_sales_pipelineboard:pipelineView","path":"v._closeLostColumnId"}},"drop":{"descriptor":"drop","value":{"exprType":"PROPERTY","byValue":false,"target":"runtime_sales_pipelineboard:pipelineView","path":"c.handleDrop"}}}}}]}}}},{"componentDef":{"descriptor":"markup://ui:dragAndDropAccessibilityMenu"},"localId":"dndAccessibilityComponent","attributes":{"values":{"class":{"descriptor":"class","value":"dndAccessibilityMenu"}}}},{"componentDef":{"descriptor":"markup://aura:html"},"attributes":{"values":{"HTMLAttributes":{"descriptor":"HTMLAttributes","value":{"class":"wrapperContainer"}},"tag":{"descriptor":"tag","value":"div"},"body":{"descriptor":"body","value":[{"componentDef":{"descriptor":"markup://runtime_sales_pipelineboard:pipelineViewMultipleRecordTypeTabSet"},"localId":"recordTypeTabSet"},{"componentDef":{"descriptor":"markup://aura:html"},"localId":"pipelineViewMain","attributes":{"values":{"HTMLAttributes":{"descriptor":"HTMLAttributes","value":{"class":"container","role":"tabPanel","id":"kanbanView"}},"tag":{"descriptor":"tag","value":"div"}}}},{"componentDef":{"descriptor":"markup://aura:html"},"localId":"maskContainer","attributes":{"values":{"HTMLAttributes":{"descriptor":"HTMLAttributes","value":{"class":"maskContainer hidden"}},"tag":{"descriptor":"tag","value":"div"},"body":{"descriptor":"body","value":[{"componentDef":{"descriptor":"markup://aura:html"},"localId":"loadingStencil","attributes":{"values":{"HTMLAttributes":{"descriptor":"HTMLAttributes","value":{"class":"loadingStencil hidden"}},"tag":{"descriptor":"tag","value":"div"},"body":{"descriptor":"body","value":[{"componentDef":{"descriptor":"markup://force:placeholder"},"attributes":{"values":{"name":{"descriptor":"name","value":"pipelineView"}}}}]}}}},{"componentDef":{"descriptor":"markup://aura:html"},"localId":"pipelineViewMessage","attributes":{"values":{"HTMLAttributes":{"descriptor":"HTMLAttributes","value":{"class":"pipelineViewMessage hidden"}},"tag":{"descriptor":"tag","value":"div"},"body":{"descriptor":"body","value":[{"componentDef":{"descriptor":"markup://aura:html"},"attributes":{"values":{"HTMLAttributes":{"descriptor":"HTMLAttributes","value":{"class":"pipelineViewMessageContainer"}},"tag":{"descriptor":"tag","value":"div"},"body":{"descriptor":"body","value":[{"componentDef":{"descriptor":"markup://aura:iteration"},"attributes":{"values":{"var":{"descriptor":"var","value":"label"},"items":{"descriptor":"items","value":{"exprType":"PROPERTY","byValue":false,"target":"runtime_sales_pipelineboard:pipelineView","path":"v.messages"}},"body":{"descriptor":"body","value":[{"componentDef":{"descriptor":"markup://aura:html"},"attributes":{"values":{"HTMLAttributes":{"descriptor":"HTMLAttributes","value":{}},"tag":{"descriptor":"tag","value":"p"},"body":{"descriptor":"body","value":[{"componentDef":{"descriptor":"markup://ui:outputText"},"attributes":{"values":{"value":{"descriptor":"value","value":{"exprType":"PROPERTY","byValue":false,"target":"runtime_sales_pipelineboard:pipelineView","path":"label"}}}}}]}}}}]}}}}]}}}}]}}}}]}}}}]}}}}]}}}}]}],"cc":"$A.componentService.addComponentClass(\"markup://runtime_sales_pipelineboard:pipelineView\",function(){return{meta:{name:\"runtime_sales_pipelineboard$pipelineView\",\"extends\":\"markup://aura:component\",imports:{componentLib:\"markup://force:componentLibrary\",pipelineLib:\"markup://runtime_sales_pipelineboard:pipelineViewLibrary\",dependentPicklistLib:\"markup://runtime_sales_pathassistant:pathAssistantDependentPicklistLibrary\",animationRuleLib:\"markup://runtime_sales_pathassistant:animationRuleLibrary\"}},\ncontroller:{init:function(a,b,c){c.initInternalData(c);c.initPipelineDataProvider(a,c,function(b){b&&(a.set(\"v._dataProvider\",[b]),b.addHandler(\"onchange\",a,\"c.handleDataChange\"),b.addHandler(\"dataProvideError\",a,\"c.handleDataProvideError\"))});a.set(\"v._dndAccessibilityContext\",a.find(\"dndAccessibilityComponent\").getGlobalId());a.set(\"v._isInitialLoading\",!0)},handleReload:function(a,b,c){var d=$A.storageService.getStorage(\"lastRecordTypeForSObject\");$A.util.isUndefinedOrNull(d)&&(d=$A.storageService.initStorage({name:\"lastRecordTypeForSObject\",\npersistent:!0,secure:!0,maxSize:524288,expiration:1209600,autoRefreshInterval:1209600,debugLogging:!1,clearOnInit:!1}));a._hasLoaded=!1;d.get(a.get(\"v.filterName\")).then($A.getCallback(function(d){\"undefined\"!==typeof d&&null!==d?a.set(\"v._recordTypeId\",d):a.set(\"v._recordTypeId\",null);c.handleReload(a,b,c)}),function(d){a.set(\"v._recordTypeId\",null);c.handleReload(a,b,c)})},handleMultipleRecordTypeTabBeforeActivate:function(a,b,c){if(b=a.find(\"recordTypeTabSet\")&&a.find(\"recordTypeTabSet\").find(\"recordTypeTabs\"))$A.util.isArray(b)&&\n(b=b[0]),b.get(\"e.getActiveTab\").setParams({callback:$A.getCallback(function(b){a._previousTab=b})}).fire()},handleMultipleRecordTypeTabActivated:function(a,b,c){var d=$A.storageService.getStorage(\"lastRecordTypeForSObject\"),e=b.getParam(\"tab\");if(!$A.util.isUndefinedOrNull(e)&&a.get(\"v._recordTypeId\")!=e.get(\"v.name\"))a.getEvent(\"confirmIfEdited\").setParams({refreshDisplay:!0,title:$A.get(\"$Label.PipelineViewSidePanel.inlineEditLeaveMessage_Title\"),bodyMessage:$A.get(\"$Label.PipelineViewSidePanel.inlineEditLeaveMessage_BodyMessage\"),\nconfirmationMessage:$A.get(\"$Label.PipelineViewSidePanel.inlineEditLeaveMessage_ConfirmationMessage\"),continueCallback:$A.getCallback(function(){a.set(\"v._recordTypeId\",e.get(\"v.name\"));d.set(a.get(\"v.filterName\"),e.get(\"v.name\"));c.getPathAssistantMetadata(a,b,c);c.handleDataChange(a,b,c);delete a._previousTab}),cancelCallback:$A.getCallback(function(){var b=a.find(\"recordTypeTabSet\")&&a.find(\"recordTypeTabSet\").find(\"recordTypeTabs\");b&&a._previousTab&&(b.get(\"e.activateTab\").setParams({index:a._previousTab.index}).fire(),\nwindow.setTimeout($A.getCallback(function(){c.focusOnActiveRecordTypeTab(a)}),0));delete a._previousTab}),stayLabel:$A.get(\"$Label.PipelineViewSidePanel.inlineEditLeaveMessage_StayButton\"),leaveLabel:$A.get(\"$Label.PipelineViewSidePanel.inlineEditLeaveMessage_LeaveButton\")}).fire();else{var f=a.find(\"recordTypeTabSet\"),g=a.getElement().getElementsByClassName(\"tabs__item active\");0<g.length&&(g=g[0].firstChild,g.onfocus=g.onclick=function(){f.set(\"v.tabFocused\",!0)})}},handleChangeOwnerPress:function(a,\nb,c){$A.getEvt(\"markup://force:changeOwnerSubmit\").fire();a.set(\"v.changeOwnerWasClicked\",!0)},handleModalCancelPress:function(a,b,c){var d=a.get(\"v.changeOwnerPanel\");d.hide(function(){d.isValid()&&d.getEvent(\"notify\").setParams({action:\"destroyPanel\",typeOf:\"ui:destroyPanel\",payload:{panelInstance:d.getGlobalId()}}).fire()});a.set(\"v.changeOwnerPanel\",null)},handleActionPerformed:function(a,b,c){a.isValid()&&c.isCmpVisible(a)&&(b.source.isInstanceOf(\"force:inlineEdit\")?(c.$focusElement$&&(c.$focusElement$.focusOnInlineEditTriggerInstead=\n!0),b=b.getParams()&&b.getParams().recordId,c.refreshRecord(a,b,c)):(a._isListChange=!0,c.displayMessage(a,\"\"),c.getPipelineData(a,!0,!0,c,a.get(\"v._recordTypeId\"))))},handleValueChange:function(a,b,c){\"v._totalRecordCount\"===b.getParam(\"expression\")&&b.getParam(\"oldValue\")&&1>b.getParam(\"value\")&&c.displayMessage(a,$A.get(\"$Label.PipelineView.NoEntities\").replace(\"{0}\",a.get(\"v._entityLabelPlural\")))},handleDataChange:function(a,b,c){var d=b.getParam(\"data\");a.set(\"v._allData\",d);d=c.getDataForCurrentRecordType(a,\nb,c);$A.util.getBooleanValue(d.hasErrors)?c.displayStencilWithErrorMessage(a,c,d.errors):c.handleDataChange(a,b,c)},handleDataProvideError:function(a,b,c){b=b.getParam(\"error\");c.handleActionError(a,b)},handleDrop:function(a,b,c){var d=b.getParams(),e=$A.dragAndDropService.getContext(d.dragComponent),f=$A.dragAndDropService.getContext(d.dropComponent),g=null;try{g=JSON.parse(d.data[\"runtime_sales_pipelineboard/pipelinedata\"])}catch(h){}if($A.util.isUndefinedOrNull(e)||$A.util.isUndefinedOrNull(f)||\n$A.util.isUndefinedOrNull(g))c.displayDragAndDropError(),d=c.pipelineLib.Dom.getParent(b.getParam(\"dropComponentTarget\"),\".runtime_sales_pipelineboardPipelineViewCardStencil\",!0),null!==d&&$A.componentService.getAttributeProviderForElement(d).dropComplete(d);else{var l=c.getPipelineColumnData(a,\"columnId\",e.get(\"v.columnId\")),k=c.getPipelineColumnData(a,\"columnId\",f.get(\"v.columnId\"));l.columnId===k.columnId?($A.dragAndDropService.fireDropComplete(b,!0),c.finishDrop(a,b,c,g.record.Id)):a.getEvent(\"confirmIfEdited\").setParams({refreshDisplay:!0,\ntitle:$A.get(\"$Label.PipelineViewSidePanel.inlineEditLeaveMessage_Title\"),bodyMessage:$A.get(\"$Label.PipelineViewSidePanel.inlineEditLeaveMessage_BodyMessage\"),confirmationMessage:$A.get(\"$Label.PipelineViewSidePanel.inlineEditLeaveMessage_ConfirmationMessage\"),continueCallback:$A.getCallback(function(){c.checkDependenciesAndHandleDrop(a,c,g,l,k,b)}),cancelCallback:$A.getCallback(function(){$A.dragAndDropService.fireDropComplete(b,!0);c.finishDrop(a,b,c,g.record.Id)}),stayLabel:$A.get(\"$Label.PipelineViewSidePanel.inlineEditLeaveMessage_StayButton\"),\nleaveLabel:$A.get(\"$Label.PipelineViewSidePanel.inlineEditLeaveMessage_LeaveButton\")}).fire()}},handlePostCreated:function(a,b,c){if(a.isValid()&&c.isCmpVisible(a)){var d=b.getParams().contextId;$A.util.isUndefinedOrNull(d)||(b=b.getParams())&&(b.feedItem&&b.feedItem.parent&&b.feedItem.parent.type)&&c.refreshRecord(a,d,c)}},handleLoadMoreCards:function(a,b,c){b=b.getParams().columnName;c.renderView(a,!0,!0,!1,!1,b,c)},resizeAggregateValue:function(a,b,c){c.resizePipelineColumnHeaders(a,!0)},onPipelineViewRendered:function(a,\nb,c){var d=\"undefined\"==typeof a.get(\"v._recordTypeId\")?null:a.get(\"v._recordTypeId\"),e=a.get(\"v._allData\");(e&&e[d]?e[d].hidePopover:1)||c.createPipelineViewHelpPopover(a,b,c);c.$focusElement$?(c.focusElement(a,c),c.$focusElement$&&delete c.$focusElement$.focusOnInlineEditTriggerInstead):a.get(\"v._isInitialLoading\")?a.set(\"v._isInitialLoading\",!1):c.pipelineLib.FieldsAndGuidance.fireSecondaryDisplayChange(a,void 0,{action:c.pipelineLib.FieldsAndGuidance.panelActions.RESET})},handleDepApply:function(a,\nb,c){if(a._dependentPicklistTreeCmp){c.toggleSpinner(!0);b=a._dropEvent;var d=b.getParams(),e=$A.dragAndDropService.getContext(d.dragComponent),f=$A.dragAndDropService.getContext(d.dropComponent),g=null;try{g=JSON.parse(d.data[\"runtime_sales_pipelineboard/pipelinedata\"])}catch(h){}var d=a.get(\"v._recordTypeId\"),d=$A.util.isUndefinedOrNull(d)?a.get(\"v._allData\")[null].groupByField:a.get(\"v._allData\")[d].groupByField,l=a._dependentPicklistTreeCmp.getAllFieldValues();if(c.checkDependentPicklistValuesForRequiredness(a,\nl,c)){for(var k in l)$A.util.isUndefinedOrNull(g.record[k])?g.record[k]=l[k]:g.record[k]!==l[k]&&k!==d&&(g.record[k]=l[k]);k=c.getPipelineColumnData(a,\"columnId\",e.get(\"v.columnId\"));f=c.getPipelineColumnData(a,\"columnId\",f.get(\"v.columnId\"));e=l[d];\"\"===e&&(e=null);e=c.getPipelineColumnData(a,\"apiNames\",e);(d=!$A.util.isUndefinedOrNull(e))&&f.apiNames[0]!==e.apiNames[0]?(a._reloadAfterDependencyModalAction=!0,f=e):d||(a._reloadAfterDependencyModalAction=!0);c.checkDependenciesAndHandleDrop(a,c,g,\nk,f,b)}c.toggleSpinner(!1)}},handleDepCancel:function(a,b,c){a._reloadAfterDependencyModalAction&&a.reload(!0);c.resetCardAndColumnValuesAfterDependencyModalExit(a,c)},handleNotify:function(a,b,c){b.stopPropagation();if(b=b.getParams())switch(b.action){case c.pipelineLib.FieldsAndGuidance.panelActions.SET_RECORD_AND_PATH:c.handleCardSelection(a,c,b);break;case c.pipelineLib.FieldsAndGuidance.panelActions.FOCUS_ON_CARD:c.focusElement(a,c)}},getSelectedRecordId:function(a,b,c){return c.$focusElement$&&\nc.$focusElement$.recordId}},helper:{$orderByFieldLabel$:\"\",$selectedCardClass$:\"is-selected\",initInternalData:function(a){a.PipelineColumnData=function(a,c,d,e,f){this.colIndex=-1;this.columnId=\"\";this.columns=$A.util.isUndefinedOrNull(c)?[]:[c];this.pipelineDataRecords=[];this.showColumn=$A.util.getBooleanValue(e);this.masterLabel=$A.util.isUndefinedOrNull(a)?\"\":a;this.apiNames=[];this.recordCount=0;this.aggregateColumn=$A.util.isUndefinedOrNull(d)?\"\":d;this.aggregateValue=null;this.groupByField=\n$A.util.isUndefinedOrNull(f)?\"\":f;this.alertCount=0;this.keyFields=[];this.guidance=null;this.pathAvailability=!1};a.PipelineColumnData.prototype={setColIndex:function(a){this.colIndex=a},setColumnId:function(a){this.columnId=a},addColumn:function(a){this.columns.push(a)},addApiName:function(a){this.apiNames.push(a)},addMasterLabel:function(a){this.masterLabel=a},addKeyFieldsAndGuidance:function(a){a&&(this.pathAvailability=!0,this.keyFields=a.fields,this.guidance=a.info)},_setColumnHeaderValue:function(a){if(a=\na.get(\"v.columnHeader\")[0])a.set(\"v.aggregateValue\",0<this.aggregateValue||0<this.recordCount?this.aggregateValue:void 0),a.set(\"v.count\",this.recordCount),0===this.recordCount&&0===this.pipelineDataRecords.length&&(this.aggregateValue=null)},addRecords:function(a,c,d){var e=c;$A.util.isUndefinedOrNull(a)&&(a=[]);0<a.length&&(!$A.util.isEmpty(this.aggregateColumn)&&null===this.aggregateValue)&&(this.aggregateValue=0);void 0===c||0>c?($A.util.merge(this.pipelineDataRecords,a),$A.util.isUndefinedOrNull(d)||\n(e=d.get(\"v.pipelineDataRecord\"),$A.util.merge(e,a),d.set(\"v.pipelineDataRecord\",e),e=e.length-1)):$A.util.forEach(a,function(a){this.pipelineDataRecords.splice(c,0,a);if(!$A.util.isUndefinedOrNull(d)){var b=d.get(\"v.pipelineDataRecord\");b.splice(c,0,a);d.set(\"v.pipelineDataRecord\",b)}c++},this);this.recordCount+=a.length;$A.util.forEach(a,function(a){var b=a.sobject;$A.util.isUndefinedOrNull(b[this.aggregateColumn])||(this.aggregateValue+=parseFloat(b[this.aggregateColumn]));!0===a.hasAlert&&this.alertCount++},\nthis);$A.util.isUndefinedOrNull(d)||this._setColumnHeaderValue(d);return e},indexOf:function(a){for(var c=0;c<this.pipelineDataRecords.length;c++)if(a===this.pipelineDataRecords[c].sobject.Id)return c;return-1},getPipelineDataRecord:function(a){a=this.indexOf(a);return-1<a?this.pipelineDataRecords[a]:null},removeRecord:function(a,c){for(var d=0;d<this.pipelineDataRecords.length;d++){var e=this.pipelineDataRecords[d].sobject;if(a.Id===e.Id)return this.recordCount--,$A.util.isUndefinedOrNull(e[this.aggregateColumn])||\n(this.aggregateValue-=e[this.aggregateColumn]),!0===this.pipelineDataRecords[d].hasAlert&&this.alertCount--,$A.util.isUndefinedOrNull(c)||(e=c.get(\"v.pipelineDataRecord\"),e.splice(d,1),c.set(\"v.pipelineDataRecord\",e),this._setColumnHeaderValue(c)),e=this.pipelineDataRecords.splice(d,1),e.index=d,e}return null},updateRecord:function(a,c){for(var d=0;d<this.pipelineDataRecords.length;d++){var e=this.pipelineDataRecords[d],f=e.sobject,g=a.sobject;if(g.Id===f.Id)return d=$A.util.isUndefinedOrNull(f[this.aggregateColumn])?\nnull:-1*f[this.aggregateColumn],$A.util.isUndefinedOrNull(g[this.aggregateColumn])||(g=parseFloat(g[this.aggregateColumn]),d=null===d?g:d+g),$A.util.isUndefinedOrNull(this.aggregateValue)?null!==d&&(this.aggregateValue=d):null!==d&&(this.aggregateValue+=d),e.hasAlert!==a.hasAlert&&(a.hasAlert?this.alertCount++:this.alertCount--),this._updatePipelineDataRecord(e,a),$A.util.isUndefinedOrNull(c)||c.updateRecord(e),e}return null},_updatePipelineDataRecord:function(a,c){if(c.sobject){var d=a.sobject||\na.record;if(d)for(var e in c.sobject)d[e]=c.sobject[e]}d=a.actionsData||a;d.actions=c.actions?c.actions:[];$A.util.isUndefinedOrNull(c.hasAlert)||(d.hasAlert=c.hasAlert);d.alertMessage=c.alertMessage?c.alertMessage:\"\";$A.util.isUndefinedOrNull(c.hasViewDetailAction)||(d.hasViewDetailAction=c.hasViewDetailAction)},computeShowColumn:function(a){this.showColumn=this.showColumn||a},sortRecords:function(a,c){if(1<this.pipelineDataRecords.length){var d=this;this.pipelineDataRecords.sort(function(e,f){var g=\na?-1:1,h=c?-1:1,l=e.sobject[d.aggregateColumn],k=f.sobject[d.aggregateColumn];return $A.util.isUndefinedOrNull(l)?h:$A.util.isUndefinedOrNull(k)?-1*h:l<k?g:l>k?-1*g:0})}},isCloseLost:function(){for(var a=0;a<this.columns.length;a++)if(!this.columns[a].attributes.closed||this.columns[a].attributes.won)return!1;return!0}};a.DataTransferTransaction=function(a,c,d,e,f){this.component=a;this.record=c;this.sourceColumn=d;this.targetColumn=e;this.targetColumnApiName=null;var g=this;this._resolveTargetColumnApiName(function(a){g.targetColumnApiName=\na;f(g)})};a.DataTransferTransaction.prototype={_resolveTargetColumnApiName:function(a){var c=this.targetColumn.columns,d;if(1<c.length&&$A.util.isUndefinedOrNull(this.component._dependentPicklistTreePanel)){d=$A.get(\"$Label.OpportunityPipelineView.moveOpptyToTitle\").replace(\"{0}\",this.targetColumn.masterLabel);var e=this;$A.createComponent(\"markup://runtime_sales_pipelineboard:pipelineViewColumnModal\",{columns:c,title:d,columnLabel:this.component.get(\"v._groupByFieldLabel\"),onSave:function(c){a(c)}},\nfunction(a,b){\"SUCCESS\"===b&&e._openStageAdvancingPanel(d,a)})}else 1===c.length&&this.targetColumn.isCloseLost()&&$A.util.isUndefinedOrNull(this.component._dependentPicklistTreePanel)?(e=this,d=$A.get(\"$Label.CloseLostConfirm.title\").replace(\"{0}\",this.component.get(\"v._groupByFieldLabel\")),$A.createComponent(\"markup://runtime_sales_pipelineboard:pipelineViewCloseConfirmModal\",{title:d,onSave:function(){a(c[0].apiName)},_closeLostMasterLabel:this.component.get(\"v._closeLostMasterLabel\")},function(a,\nb){\"SUCCESS\"===b&&e._openStageAdvancingPanel(d,a)})):a(c[0].apiName)},_openStageAdvancingPanel:function(a,c){$A.getEvt(\"markup://force:showPanel\").setParams({title:a,isScrollable:!1,isFullScreen:!1,autoFocus:!0,closeOnActionButtonClick:!1,useTransition:!0,attributes:{animation:\"pop\",closeAnimation:\"pop\"},onCreate:function(a){a.update({body:c})}}).fire()},transferData:function(b,c){this.data=c;var d=a.getPipelineColumn(this.component,this.sourceColumn.columnId),e=this.sourceColumn.removeRecord(this.record,\nd);if(null===e)throw\"InvalidStateException\";var d={index:e.index,count:1,remove:!0},f=a.getPipelineColumn(this.component,this.targetColumn.columnId),g=!f.isInstanceOf(\"runtime_sales_pipelineboard:pipelineViewCloseLostTarget\");if(g){var h=a.getPipelineViewCardIndex(b.getParam(\"dropComponentTarget\")),h=this.targetColumn.addRecords(e,h,f);c.actionsData.dndContext=f.getGlobalId();c.actionsData.dndAccessibilityContext=this.component.get(\"v._dndAccessibilityContext\");e={index:h,items:[c]};this.component._reloadAfterDependencyModalAction||\n$A.dragAndDropService.moveDataTransfer(b,e,d)}else this.component.set(\"v._totalRecordCount\",this.component.get(\"v._totalRecordCount\")-1),a.fireEventForObjectHomeStatus(this.component,this.component.get(\"v._totalRecordCount\"),a.$orderByFieldLabel$),$A.dragAndDropService.removeDataTransfer(b,d);this.sourceColumn.pipelineDataRecords&&0===this.sourceColumn.pipelineDataRecords.length&&(this.sourceColumn.aggregateValue=null);return g},save:function(b,c){var d=this.record.Id;if(!a.$transactionCollection$.contains(d)){a.$transactionCollection$.push(d,\nthis);var e=function(e,g){a.$transactionCollection$.pop(d);e&&b?b(g):!e&&c&&c(g)};a.updateRecord(this.component,this.record,this.targetColumn.groupByField,this.targetColumnApiName,function(a){e(!0,a)},function(a){e(!1,a)})}},revert:function(){var b=a.getPipelineColumn(this.component,this.targetColumn.columnId),c=a.getPipelineColumn(this.component,this.sourceColumn.columnId),d=null;b.isInstanceOf(\"runtime_sales_pipelineboard:pipelineViewCloseLostTarget\")||(d=this.targetColumn.removeRecord(this.record,\nb),this.targetColumn.pipelineDataRecords&&0===this.targetColumn.pipelineDataRecords.length&&(this.targetColumn.aggregateValue=null),b=b.getEvent(\"addRemove\"),b.setParams({remove:!0,index:d.index}),b.fire());null===d&&(d={hasAlert:this.data.actionsData.hasAlert,hasViewDetailAction:this.data.actionsData.hasViewDetailAction,sobject:this.data.record},$A.util.isUndefinedOrNull(this.data.actionsData.alertMessage)||(d.alertMessage=this.data.actionsData.alertMessage),$A.util.isUndefinedOrNull(this.data.actionsData.actions)||\n(d.actions=this.data.actionsData.actions),d=[d]);this.sourceColumn.addRecords(d,0,c);d=c.getEvent(\"addRemove\");this.data.actionsData.dndContext=c.getGlobalId();this.data.actionsData.dndAccessibilityContext=this.component.get(\"v._dndAccessibilityContext\");d.setParams({remove:!1,index:0,items:[this.data]});d.fire()}};a.TransactionCollection=function(){this.collection={}};a.TransactionCollection.prototype={push:function(a,c){this.collection[a]=c},pop:function(a){delete this.collection[a]},get:function(a){return this.collection[a]},\ncontains:function(a){a=this.get(a);return $A.util.isUndefinedOrNull(a)?!1:!0}};a.$transactionCollection$=new a.TransactionCollection;a.$focusElement$=null},initPipelineDataProvider:function(a,b,c){$A.createComponent(\"markup://runtime_sales_pipelineboard:genericPipelineDataProvider\",{scope:a.get(\"v.scope\")},function(a){c(a)})},getPipelineData:function(a,b,c,d,e){d.showLoading(a,d);d.getRecordLayout(a,b,d);var f=a.get(\"v._dataProvider[0]\"),g=a.get(\"v.filterName\"),h=a.get(\"v.searchString\");f.set(\"v.filterName\",\ng);f.set(\"v.recordTypeId\",e);f.set(\"v.searchString\",h);e=f.getEvent(\"provide\");e.setParams({parameters:{forceReload:b,showCachedDataIfPresent:c}});h&&1<h.length||null==h?e.fire():d.displayStencilWithErrorMessage(a,d,$A.get(\"$Label.Page_SearchResult.invalid_search_term\"));a.set(\"v._showCelebration\",!0)},getColumnHeaderDefinition:function(a,b){return[\"markup://runtime_sales_pipelineboard:pipelineViewColumnHeader\",{label:b.masterLabel,domId:b.columnId,count:b.recordCount,aggregateValue:b.aggregateValue,\naggregateValueFormat:a.get(\"v._aggregateValueFormat\"),headerClass:\"pipelineHeader\",aggregateColumnClass:\"pipelineAggregateHeader\",\"aura:id\":\"pipelineViewColumnHeader\"}]},getColumnDefinition:function(a,b,c,d){return[\"markup://runtime_sales_pipelineboard:pipelineViewColumn\",{filterName:a.get(\"v.filterName\"),apiNames:b.apiNames,\"class\":\"pipelineColumn\",columnId:b.columnId,ariaDescribedBy:b.columnId,pipelineDataRecord:b.pipelineDataRecords.slice(0,d),itemTemplate:a.get(\"v._itemTemplate\"),itemVar:a.get(\"v.itemVar\"),\nrecordExpression:a.get(\"v.recordExpression\"),actionsExpression:a.get(\"v.actionsExpression\"),drop:a.getReference(\"c.handleDrop\"),label:b.masterLabel,dndAccessibilityContext:a.get(\"v._dndAccessibilityContext\"),\"aura:id\":\"pipelineViewColumn\",columnHeader:c}]},renderCards:function(a,b,c,d){var e=a.get(\"v._columnItems\").filter(function(a){return a.showColumn&&a.apiNames[0]===b})[0];c=c.filter(function(a){return a.get(\"v.apiNames\")[0]===b})[0];if(!$A.util.isUndefinedOrNull(e)&&!$A.util.isUndefinedOrNull(c)){var f=\nc.get(\"v.pipelineDataRecord\"),g=f.length,h=this.getPipelineColumn(a,c.get(\"v.columnId\"));if(!$A.util.isUndefinedOrNull(h)&&h.getElement().querySelectorAll(\"li\").length===g&&g<e.pipelineDataRecords.length){for(var l=g,h=[];l<g+d&&l<e.pipelineDataRecords.length;){var k=e.pipelineDataRecords[l];f.push(k);c.set(\"v.pipelineDataRecord\",f);var m={};m[a.get(\"v.recordExpression\")]=k.sobject;m[a.get(\"v.actionsExpression\")]={dndContext:c.getGlobalId(),dndAccessibilityContext:a.get(\"v._dndAccessibilityContext\"),\nhasAlert:k.hasAlert,alertMessage:k.alertMessage,actions:k.actions,hasViewDetailAction:k.hasViewDetailAction};h.push(m);l+=1}a=c.getEvent(\"addRemove\");a.setParams({remove:!1,index:-1,items:h});a.fire()}}},renderView:function(a,b,c,d,e,f,g){var h=a.find(\"pipelineViewMain\");if(!$A.util.isUndefinedOrNull(h)){var l=h.getElement().clientWidth/175,k=h.getElement().clientHeight/40;0===k&&(k=a.get(\"v._totalRecordCount\"));var m=0,p=h.get(\"v.body\");b&&(m=p.length);var s;s=e||0===l?a.get(\"v._columnItems\").length:\nm+l;e=function(b){$A.createComponents(b,$A.getCallback(function(b,c,d){if(\"SUCCESS\"===c){c=a.get(\"v._columnItems\").filter(function(a){return a.showColumn});d=[];var e=m;for(e;e<s&&e<c.length;e+=1){var f=c[e];f.showColumn&&d.push(g.getColumnDefinition(a,f,b[d.length],k))}$A.createComponents(d,$A.getCallback(function(b,c,d){\"SUCCESS\"===c&&(h=a.find(\"pipelineViewMain\"),p=h.get(\"v.body\"),p=p.concat(b),h.set(\"v.body\",p))}))}}))};h&&!b&&(h.set(\"v.body\",[]),p=h.get(\"v.body\"));if(c)b&&0<p.length&&g.renderCards(a,\nf,p,k);else if(d&&(b=a.get(\"v._columnItems\").filter(function(a){return a.showColumn}),0!==b.length&&b.length!==p.length)){c=[];d=m;for(d;d<s&&d<b.length;d+=1)f=b[d],f.showColumn&&c.push(g.getColumnHeaderDefinition(a,f));e(c)}}},getPipelineColumn:function(a,b){if(a.get(\"v._closeLostColumnId\")===b)return a.find(\"closeLostTarget\");for(var c=a.find(\"pipelineViewMain\").get(\"v.body\"),d=0;d<c.length;d++)if(c[d].isRendered()&&c[d].get(\"v.columnId\")===b)return c[d];return null},getPipelineColumnData:function(a,\nb,c){a=a.get(\"v._columnItems\");for(var d=0;d<a.length;d++){var e=\"apiNames\"===b?e=a[d][b][0]:e=a[d][b];if(e===c)return a[d]}return null},getPipelineColumnDataOfCard:function(a,b){for(var c=a.get(\"v._columnItems\"),d=0;d<c.length;d++){var e=c[d];if(-1!==e.pipelineDataRecords.map(function(a){return a.sobject.Id}).indexOf(b))return e}return null},getRecordLayout:function(a,b,c){a.$layoutTemplatePromise$=new Promise(function(b,e){var f={recordExpression:c.getRecordExpression(a),actionsExpression:c.getActionsExpression(a),\nentityName:a.get(\"v.scope\"),mode:\"VIEW\",type:\"LIST\",layoutOverride:a.get(\"v.filterName\"),inContextOfComponent:\"runtime_sales_pipelineboard:pipelineView\"};$A.createComponent(\"markup://force:listTemplate\",f,function(a,c){a?b(a):e(c)})})},getRecordExpression:function(a){return a.get(\"v.itemVar\")+\".\"+a.get(\"v.recordExpression\")},getActionsExpression:function(a){return a.get(\"v.itemVar\")+\".\"+a.get(\"v.actionsExpression\")},getPipelineViewCardIndex:function(a){var b=-1;if((a=this.pipelineLib.Dom.getParent(a,\n\".runtime_sales_pipelineboardPipelineViewCardStencil\",!0))&&this.pipelineLib.Dom.getParent(a,\"ul\")){var c=this.pipelineLib.Dom.getParent(a,\"ul\").children;if(c)for(var d=0;d<c.length;d++)if(a===c[d]){b=d;break}}return b},getPipelineViewColumnIndex:function(a){var b=-1;a=this.pipelineLib.Dom.getParent(a,\".runtime_sales_pipelineboardPipelineViewColumn\",!0);if(!$A.util.isUndefinedOrNull(a)){var c=this.pipelineLib.Dom.getParent(a,\".runtime_sales_pipelineboardPipelineView .container\").children;if(c)for(var d=\n0;d<c.length;d++)if(a===c[d]){b=d;break}}return b},toggleMaskContainer:function(a,b){var c=a.find(\"maskContainer\").getElement();if(c){var d=$A.util.hasClass(c,\"hidden\");b&&d?$A.util.removeClass(c,\"hidden\"):!b&&!d&&$A.util.addClass(c,\"hidden\")}},isCmpVisible:function(a){return!$A.util.isUndefinedOrNull(a.getElement().offsetParent)&&\"hidden\"!==window.getComputedStyle(a.getElement()).visibility},showLoading:function(a,b){a.$isLoading$=!0;b.componentLib.placeholders.delay(a,function(){if(a.$isLoading$){b.toggleMaskContainer(a,\n!0);var c=a.find(\"loadingStencil\").getElement();$A.util.removeClass(c,\"hidden\");$A.util.removeClass(c,\"ease-out\");$A.util.addClass(c,\"ease-in\")}})},hideLoading:function(a){a.$isLoading$&&(a.$isLoading$=!1,this.toggleMaskContainer(a,!1),a=a.find(\"loadingStencil\").getElement(),$A.util.removeClass(a,\"ease-in\"),$A.util.addClass(a,\"ease-out\"))},toggleCloseLostTarget:function(a,b){var c=a.find(\"closeLostTarget\");c&&c.toggleVisibility(b)},handleActionError:function(a,b){\"INCOMPLETE\"===b.getState()&&$A.getEvt(\"markup://force:showOfflineMessage\").setParams({retryAction:b}).fire()},\ngetDraggableElements:function(a,b){if(!$A.util.isUndefinedOrNull(a)){var c=a.getElementsByClassName(\"runtime_sales_pipelineboardPipelineViewCardStencil\")[b];if(void 0!==c)return c.getElementsByClassName(\"uiDraggable\")}return null},disableDnDOnPipelineCardsInTransaction:function(a){var b=a.$transactionCollection$.collection,c;for(c in b)if(b.hasOwnProperty(c)){var d=b[c],e=a.getPipelineColumn(d.component,d.targetColumn.columnId),d=d.targetColumn.indexOf(d.record.Id),e=a.getDraggableElements(e.getElement(),\nd);if(null!=e)for(d=0;d<e.length;d++){var f=e[d];f.setAttribute(\"draggable\",\"false\");f.classList.add(\"disabled\")}}},rememberFocus:function(a,b,c,d){if($A.util.isUndefinedOrNull(b)&&$A.util.isUndefinedOrNull(c))a.$focusElement$=null;else{var e=this.pipelineLib.Dom.getParent(b,\"li.runtime_sales_pipelineboardPipelineViewCardStencil\",!0);c=$A.util.isUndefinedOrNull(c)?a.getPipelineViewColumnIndex(e)+1:c+1;d=$A.util.isUndefinedOrNull(d)?a.getPipelineViewCardIndex(e)+1:d+1;e=null;if(null!=b)for(var f=b.classList,\ng=0;g<f.length;g++)this.pipelineLib.Utils.isId(f[g])&&(e=f[g]);a.$focusElement$={recordId:e,element:b,colIndex:c,cardIndex:d,focusOnInlineEditTriggerInstead:a.$focusElement$&&a.$focusElement$.focusOnInlineEditTriggerInstead}}},focusElement:function(a,b){if(null!==b.$focusElement$){if(!b.$focusElement$.focusOnInlineEditTriggerInstead)if(document.body.contains(b.$focusElement$.element))b.$focusElement$.element.focus();else{var c=a.getElement().querySelector(\".runtime_sales_pipelineboardPipelineViewColumn:nth-of-type(\"+\nb.$focusElement$.colIndex+\")\");c&&(c=c.querySelector(\".runtime_sales_pipelineboardPipelineViewCardStencil:nth-of-type(\"+b.$focusElement$.cardIndex+\")\"))&&c.querySelector(\".uiDraggable\").focus()}b.$focusElement$.recordId?b._handleCardSelection(a,b,b.$focusElement$.recordId):b.$focusElement$=null}},createDependencyTreeComponent:function(a,b){if(!$A.util.isUndefinedOrNull(a._dropEvent)){var c=a._dropEvent.getParams(),c=$A.dragAndDropService.getContext(c.dropComponent),c=this.getPipelineColumnData(a,\n\"columnId\",c.get(\"v.columnId\"));b[c.groupByField]=c.apiNames[0];var d=a.get(\"v._recordTypeId\");$A.util.isUndefinedOrNull(d);a.get(\"v._allData\")}$A.createComponents([[\"markup://lightning:button\",{label:$A.get(\"$Label.Buttons.done\"),variant:\"brand\",\"aura:id\":\"apply\",type:\"submit\",onclick:a.get(\"c.handleDepApply\")}],[\"markup://lightning:button\",{label:$A.get(\"$Label.Buttons.cancel\"),\"aura:id\":\"cancel\",onclick:a.get(\"c.handleDepCancel\")}],[\"force:dependentFieldContainer\",{entityApiName:b.sobjectType,\nrecordTypeId:a.get(\"v._recordTypeId\")||\"012000000000000AAA\",recordId:b.Id,layoutType:\"FULL\",fieldValues:b,mode:\"EDIT\",targetField:c.groupByField}]],function(b,c,d){if(\"SUCCESS\"===c){c=b[0];d=b[1];var h=b[2];$A.getEvt(\"markup://ui:createPanel\").setParams({panelType:\"modal\",visible:!0,onCreate:function(b){a._dependentPicklistTreePanel=b;a._dependentPicklistTreeCmp=h},panelConfig:{title:$A.get(\"$Label.ForceRecord.dependentEditModal\"),body:h,footer:[d,c],showCloseButton:!1,useTransition:!0}}).fire()}else this.componentLib.actions.showCreateComponentError(a.getType(),\n[\"ui:button\",\"force:dependentFieldContainer\"],Error(d))}.bind(this));this.renderView(a,!0,!1,!0,!0,null,this)},resetCardAndColumnValuesAfterDependencyModalExit:function(a,b){var c=a.get(\"v._recordData\"),d=a._dropEvent.getParams(),e=$A.dragAndDropService.getContext(d.dragComponent),e=b.getPipelineColumnData(a,\"columnId\",e.get(\"v.columnId\"));c[e.groupByField]=e.apiNames[0];b.removeDropTarget(d);a._dependentPicklistTreePanel.close();a._dependentPicklistTreeCmp=void 0;a._dependentPicklistTreePanel=void 0;\na._reloadAfterDependencyModalAction=void 0;a._dropEvent=void 0},removeDropTarget:function(a){if(null!==a&&(a=a.dropComponentTarget))a=this.pipelineLib.Dom.getParent(a,\".runtime_sales_pipelineboardPipelineViewCardStencil\",!0),null!==a&&$A.componentService.getAttributeProviderForElement(a).dropComplete(a)},displayErrorMessages:function(a,b,c,d){var e=c.Name;b=b.getReturnValue();if(!$A.util.isUndefinedOrNull(b)&&b.hasErrors){var f=\"\",g=null,h=b.pageErrors;if(!$A.util.isUndefinedOrNull(h))for(var l in h)f+=\n\"\\n\"+h[l];0<f.length&&(e?this.displayToast($A.get(\"$Label.Error.toastTitle\").replace(\"{0}\",e),f,!0):this.displayToast($A.get(\"$Label.Error.toastTitleGenericLabelForRecord\"),f,!0));e=b.fieldErrors;if(b.hasOnlyDependentFieldErrors)if(a._dependentPicklistTreeCmp){var k=[],m;for(m in e)e.hasOwnProperty(m)&&k.push({fieldName:m,message:e[m][0]});a._dependentPicklistTreeCmp.clearErrors();a._dependentPicklistTreeCmp.displayErrors(k)}else{for(m in e)e.hasOwnProperty(m)&&$A.util.isUndefinedOrNull(e[m][0])&&\n(c[m]=\"\");this.createDependencyTreeComponent(a,c)}else if(e){a._dependentPicklistTreeCmp&&a._dependentPicklistTreePanel&&(a._dependentPicklistTreePanel.close(),a._dependentPicklistTreeCmp=void 0,a._dependentPicklistTreePanel=void 0);g=[{pageErrors:[],fieldErrors:{},potentialDuplicates:[]}];for(m in e)e.hasOwnProperty(m)&&(k={message:e[m][0]},g[0].pageErrors=[k]);var p=void 0;if(a._dropEvent){var s=$A.dragAndDropService.getContext(a._dropEvent.getParams().dropComponent);m=this.getPipelineColumnData(a,\n\"columnId\",s.get(\"v.columnId\"));s=a.get(\"v._groupByFieldName\");p=m.apiNames[0]}var q={};q[s]=p;if(\"Task\"===a.get(\"v.scope\")){m=d.getDataForCurrentRecordType(a).layoutMetadata.dependentPicklistMetadata;for(var r in m)q[r]=null}if(k.message.includes($A.get(\"$Label.Edit.RequiredWithFieldList\").replace(\"{0}\",\"\")))for(var n in e)q[n]=null;\"Opportunity\"===a.get(\"v.scope\")&&\"StageName\"===s?(k=(k=a.get(\"v._stageDependencyMap\"))&&k[p])?d.addDependentFieldValuesToMapAndFireEditRecordEvent(k,q,c,g,d):(b=a.get(\"c.getStageDependencyMap\"),\nb.setParams({recordTypeId:c.RecordTypeId}),b.setCallback(this,function(b){\"SUCCESS\"===b.getState()?(d.updateStageDependencyMap(a,b.getReturnValue()),b=a.get(\"v._stageDependencyMap\")[p],d.addDependentFieldValuesToMapAndFireEditRecordEvent(b,q,c,g,d)):\"ERROR\"===b.getState()?$A.log(\"Error retrieving stage dependency data: \"+b.getError()[0].message):\"INCOMPLETE\"===b.getState()&&$A.log(\"Unable to reach the server: \"+b.getError()[0].message)}),b.setStorable(),$A.enqueueAction(b)):d.fireEditRecordEvent(q,\nc,g)}}},updateStageDependencyMap:function(a,b){for(var c=a.get(\"v._stageDependencyMap\")||{},d=b.stageDependencyMap,e=Object.keys(d),f=0;f<e.length;f++)c[e[f]]=d[e[f]];a.set(\"v._stageDependencyMap\",c)},addDependentFieldValuesToMapAndFireEditRecordEvent:function(a,b,c,d,e){a.probability&&(b.Probability=a.probability);a.forecastCategory&&(b.ForecastCategoryName=a.forecastCategory);e.fireEditRecordEvent(b,c,d)},fireEditRecordEvent:function(a,b,c){$A.getEvt(\"markup://force:editRecord\").setParams({recordId:b.Id,\nnavigationLocation:\"DETAIL\",errors:c,newFieldValues:a}).fire()},displayToast:function(a,b,c){var d=$A.getEvt(\"markup://force:showToast\");d.setParams({title:a,message:b,mode:c?\"sticky\":\"\",key:\"warning\"});d.fire()},displayMessage:function(a,b){b=$A.util.isArray(b)?b:\"\"===b?[]:[b];a.set(\"v.messages\",b);var c=a.find(\"pipelineViewMessage\").getElement(),d=$A.util.isEmpty(b),e=$A.util.hasClass(c,\"hidden\"),f=a.find(\"loadingStencil\").getElement();d&&!e?($A.util.addClass(c,\"hidden\"),$A.util.removeClass(f,\"ease-in\"),\n$A.util.addClass(f,\"ease-out\")):!d&&e&&($A.util.removeClass(c,\"hidden\"),$A.util.removeClass(f,\"ease-out\"),$A.util.addClass(f,\"ease-in\"));this.toggleMaskContainer(a,!d)},displayStencilWithErrorMessage:function(a,b,c){a.set(\"v._columnItems\",[]);a.find(\"recordTypeTabSet\").set(\"v.allRecordTypesInfo\",{recordTypesInfo:[],tabIdToActivate:[],count:0});b.fireEventForObjectHomeStatus(a,0,null);b.hideLoading(a);b.displayMessage(a,c);b.fireListChangeComplete(a)},displayDragAndDropError:function(){$A.getEvt(\"markup://force:showMessage\").setParams({message:$A.get(\"$Label.OpportunityPipelineView.dragAndDropGenericErrorMessage\"),\nseverity:\"error\"}).fire()},resizePipelineColumnHeaders:function(a,b){var c=a.find(\"pipelineViewColumnHeader\");c&&($A.util.isArray(c)||(c=[c]),$A.util.forEach(c,function(a){var c=a.getElement();c&&(a=a.get(\"v.aggregateValue\"),c=c.getElementsByClassName(\"pipelineAggregateHeader\")[0],null!=a&&c&&(1E9<=a?c.classList.add(\"largeAmount\"):b&&c.classList.remove(\"largeAmount\")))}))},handleReload:function(a,b,c){a.find(\"recordTypeTabSet\").set(\"v.tabFocused\",!1);var d=b.getParams().arguments;b=$A.util.getBooleanValue(d.forceReload);\nd=d.showCachedDataIfPresent;a._isListChange=!0;c.displayMessage(a,\"\");c.getPipelineData(a,b,d,c,a.get(\"v._recordTypeId\"))},getCurrentRecordTypeId:function(a){return\"undefined\"===typeof a.get(\"v._recordTypeId\")?null:a.get(\"v._recordTypeId\")},getDataForCurrentRecordType:function(a){var b=a.get(\"v._allData\"),c=Object.keys(b);a=this.getCurrentRecordTypeId(a);a=b[a];$A.util.isUndefinedOrNull(a)&&0<c.length&&(a=b[c[0]]);return a},setDataForCurrentRecordType:function(a,b,c){var d=a.get(\"v._allData\");b=b.getCurrentRecordTypeId(a);\nd[b]=c;a.set(\"v._allData\",d)},getCompactLayoutFieldsForCurrentRecordType:function(a,b){var c=a.get(\"v._allData\"),d=b.getCurrentRecordTypeId(a);return c[d]?c[d].compactLayoutFields:null},_buildPathAssistantStepMap:function(a){return a?a.reduce(function(a,c){a[c.value]={fields:c.fields,info:c.info};return a},{}):null},getPathAssistantMetadata:function(a,b,c){if(!c.getDataForCurrentRecordType(a)._isPathAssistantFetched){var d=a.get(\"c.getPathAssistantAndAnimationRule\");d.setParams({entityName:a.get(\"v.scope\"),\ngroupByField:a.get(\"v._groupByFieldName\"),recordTypeId:a.get(\"v._recordTypeId\")});d.setCallback(this,function(b){var f=b.getState();\"SUCCESS\"===f?(b=b.getReturnValue(),c.handlePathAssistantFetch(a,c,b)):\"ERROR\"===b.getState()?b.getError()&&b.getError()[0]&&$A.log(\"Error getting PathAssistant metadata: \"+b.getError()[0].message):\"INCOMPLETE\"===f&&$A.getEvt(\"markup://force:showOfflineMessage\").setParams({retryAction:d}).fire()});d.setAbortable();$A.enqueueAction(d);a.set(\"v._isPathAssistantMetadataLoading\",\n!0)}},handlePathAssistantFetch:function(a,b,c){var d=b.getDataForCurrentRecordType(a);d._isPathAssistantFetched=!0;c&&(d.pathAssistant=c,(c=b._buildPathAssistantStepMap(c.pathAssistantSteps))&&b.setPathAssistantMetadataToColumnItems(a,c));b.setDataForCurrentRecordType(a,b,d);a.set(\"v._isPathAssistantMetadataLoading\",!1);b.$focusElement$&&b.$focusElement$.recordId&&b._handleCardSelection(a,b,b.$focusElement$.recordId)},setPathAssistantMetadataToColumnItems:function(a,b){var c=a.get(\"v._columnItems\");\n$A.util.forEach(c,function(a,c){a.addKeyFieldsAndGuidance(b[a.apiNames[0]])});a.set(\"v._columnItems\",c)},handleDataChange:function(a,b,c){b=c.getDataForCurrentRecordType(a);var d=null,e=b.columns,f=b.records,g=0,h=b.aggregateColumn,l=0,k=0,m=[],p=b.groupByField,s=new c.PipelineColumnData($A.get(\"$Label.OpportunityPipelineView.closeWonStageName\"),null,h,!1,p),q=new c.PipelineColumnData($A.get(\"$Label.OpportunityPipelineView.closeLostStageName\"),null,h,!1,p);c.$orderByFieldLabel$=b.orderByFieldLabel;\nb.pathAssistant&&(d=c._buildPathAssistantStepMap(b.pathAssistant.pathAssistantSteps));b._isPathAssistantFetched=!0;if(!$A.util.isUndefinedOrNull(f[null])){var r=!1,n=e[0];n&&(r=null===n.apiName);r||(r=$A.get(\"$Label.Global.labelInDashes\").replace(\"{0}\",$A.get(\"$Label.Global.none\")),e.unshift({apiName:null,attributes:{closed:!1,sortOrder:0,won:!1},label:r,masterLabel:r,showColumn:!0}))}$A.util.forEach(e,function(b,e){var n=null;$A.util.getBooleanValue(b.attributes.closed)&&\"Opportunity\"===a.get(\"v.scope\")?\n$A.util.getBooleanValue(b.attributes.won)?(s.addColumn(b),s.computeShowColumn(b.showColumn),s.addApiName(b.apiName),s.addMasterLabel(b.masterLabel),d&&s.addKeyFieldsAndGuidance(d[b.apiName]),n=s):(q.addColumn(b),q.computeShowColumn(b.showColumn),q.addApiName(b.apiName),q.addMasterLabel(b.masterLabel),d&&q.addKeyFieldsAndGuidance(d[b.apiName]),n=q):(b.attributes.closed=!1,n=new c.PipelineColumnData(b.masterLabel,b,h,b.showColumn,p),n.addApiName(b.apiName),d&&n.addKeyFieldsAndGuidance(d[b.apiName]),\nc.addPipelineColumnData(a,m,n),!0===n.showColumn&&l++);n.addRecords(f[b.apiName],void 0,null);g+=f[b.apiName]?f[b.apiName].length:0;k+=n.alertCount});0<s.columns.length&&(1<s.columns.length&&s.addMasterLabel($A.get(\"$Label.OpportunityPipelineView.closeWonStageName\")),s.sortRecords(!1,!1),c.addPipelineColumnData(a,m,s),!0===s.showColumn&&l++);0<q.columns.length&&(1<q.columns.length&&q.addMasterLabel($A.get(\"$Label.OpportunityPipelineView.closeLostStageName\")),q.sortRecords(!1,!1),c.addPipelineColumnData(a,\nm,q),!0===q.showColumn&&l++);c.fireEventForObjectHomeStatus(a,g,c.$orderByFieldLabel$);0<g&&c.displayMessage(a,\"\");e={alertCount:k,stageCount:l};a.set(\"v._recordTypeId\",b.recordTypeId);r=a.find(\"recordTypeTabSet\");r.set(\"v.entityLabel\",b.entityLabel);var n=a.get(\"v._allData\"),u={},t;for(t in n){var w=0,v;for(v in n[t].records)w+=n[t].records[v].length;u[t]=w}t={recordTypesInfo:b.recordTypeIds,tabIdToActivate:b.recordTypeId,count:u};2>b.recordTypeIds.length&&a.find(\"pipelineViewMain\").getElement().removeAttribute(\"role\");\nv=!1;if(!$A.util.isUndefinedOrNull(a._allRecordTypesInfo)&&!$A.util.isUndefinedOrNull(t.recordTypesInfo))if(a._allRecordTypesInfo.recordTypesInfo.length===t.recordTypesInfo.length)for(n=0;n<t.recordTypesInfo.length;n++){if(a._allRecordTypesInfo.recordTypesInfo[n].id!==t.recordTypesInfo[n].id){v=!0;break}}else v=!0;if(!a._hasLoaded||v||$A.util.isUndefinedOrNull(a._allRecordTypesInfo))r.set(\"v.allRecordTypesInfo\",t),a._hasLoaded=!0;c.setDataForCurrentRecordType(a,c,b);a._allRecordTypesInfo=t;c.refreshPipelineViewColumn(a,\n{columnItems:m,columnApiName:p,closeLostColumnId:q.columnId,closeLostHasPopup:1<q.columns.length,totalRecordCount:g,groupByField:b.groupByField,groupByFieldLabel:b.groupByFieldLabel,groupByFieldType:b.groupByFieldType,entityLabel:b.entityLabel,entityLabelPlural:b.entityLabelPlural,aggregateColumnFormat:b.aggregateColumnFormat,logInfo:e,fields:b.fields,closeLostMasterLabel:q.masterLabel},c)},addPipelineColumnData:function(a,b,c){a=a.getGlobalId()+\";\"+b.length;c.setColumnId(a);c.setColIndex(b.length+\n1);b.push(c)},refreshPipelineViewColumn:function(a,b,c){a.$layoutTemplatePromise$.then($A.getCallback(function(d){if(a.isValid()){var e=d.get(\"v.priv_itemTemplate\");a.set(\"v._listTemplate\",d);a.set(\"v._itemTemplate\",e);a.set(\"v._logInfo\",b.logInfo);a.set(\"v._totalRecordCount\",b.totalRecordCount);a.set(\"v._columnItems\",b.columnItems);a.set(\"v._closeLostColumnId\",b.closeLostColumnId);a.set(\"v._closeLostMasterLabel\",b.closeLostMasterLabel);a.set(\"v._closeLostHasPopup\",b.closeLostHasPopup);a.set(\"v._groupByFieldName\",\nb.groupByField);a.set(\"v._groupByFieldLabel\",b.groupByFieldLabel);a.set(\"v._groupByFieldType\",b.groupByFieldType);a.set(\"v._entityLabel\",b.entityLabel);a.set(\"v._entityLabelPlural\",b.entityLabelPlural);a.set(\"v._fields\",b.fields);$A.util.isUndefinedOrNull(b.aggregateColumnFormat)||a.set(\"v._aggregateValueFormat\",b.aggregateColumnFormat);c.renderView(a,!1,!1,!0,!1,null,c);b.focusElement?c.$focusElement$=b.focusElement:c.rememberFocus(c,null);c.hideLoading(a);1>b.totalRecordCount&&c.displayMessage(a,\n$A.get(\"$Label.PipelineView.NoEntities\").replace(\"{0}\",a.get(\"v._entityLabelPlural\")));c.fireListChangeComplete(a);c.logTransactionEnd(a,!0);a.find(\"recordTypeTabSet\").get(\"v.tabFocused\")&&c.focusOnActiveRecordTypeTab(a);window.setTimeout($A.getCallback(function(){var b=a.getEvent(\"pipelineViewRenderedEvent\");b&&b.fire()}),0)}}),$A.getCallback(function(){c.logTransactionEnd(a,!1)}))},focusOnActiveRecordTypeTab:function(a){a=a.getElement().getElementsByClassName(\"tabs__item active\");0<a.length&&a[0].firstChild.focus()},\ncreatePipelineViewHelpPopover:function(a,b,c){b=a.getElement()?a.getElement().getElementsByClassName(\"pipelineViewCard\"):null;var d;if(b)for(var e=0;e<b.length;e++)if(b[e]&&b[e].draggable){d=b[e];break}if(d&&d.draggable&&(a=a.find(\"userAssistancePopoversManager\")))a.showPopOver(\"KanbanViewHelpPopover\",\"userAssistancePopovers\",\"KanbanViewHelpPopover\",d,c.getDirectionOfModal(d),$A.get(\"$Label.KanbanViewHelpPopover.KanbanViewHelpPopoverText\"),$A.get(\"$Label.KanbanViewHelpPopover.KanbanViewHelpPopoverTitle\"),\nd,d,\"utility:touch_action\"),$A.util.addClass(d,\"shake\")},fireListChangeComplete:function(a){a._isListChange&&(a._isListChange=!1,a.getEvent(\"listChangeComplete\").fire())},shouldUpdateRecord:function(a,b,c,d){return $A.util.isUndefinedOrNull(c)||d.$transactionCollection$.contains(b.Id)||0<=c.apiNames.indexOf(b[c.groupByField])&&!a._dependentPicklistTreeCmp?!1:!0},updateRecord:function(a,b,c,d,e,f){var g={Id:b.Id};if(a._dependentPicklistTreePanel&&a._dependentPicklistTreePanel.get(\"v.body\")){c=a._dependentPicklistTreePanel.get(\"v.body\")[0].getAllFieldValues();\nfor(var h in c)g[h]=c[h]}else g[c]=d;h=this.getDataForCurrentRecordType(a);this.dependentPicklistLib.DependentPicklist.removeInvalidValuesForDependentPicklistFields(a,g,b,h.layoutMetadata,a.get(\"v._groupByFieldName\"),this);h=a.get(\"c.saveRecord\");h.setParams({record:g,fields:a.get(\"v._fields\"),recordTypeId:a.get(\"v._recordTypeId\"),listViewId:a.get(\"v.filterName\"),allData:a.get(\"v._allData\")});h.setCallback(this,function(c){var g=this.getLoggingPayload(a.get(\"v.scope\"),\"DragAndDrop\",\"runtime_sales_pipelineboard:pipelineView:saveOnDragAndDrop\");\ng.context.stageName=d;g.context.usageInfo.recordId=b.Id;g.context.cudAction=\"Update\";g.context.state=c.getState();g=Object.keys(a.get(\"v._allData\")).length;$A.metricsService.transaction(\"ltng\",\"interaction\",{context:{eventSource:\"synthetic-dragdrop\",eventType:\"user\",locator:{target:\"pipeline-view\",scope:\"pipeline-card\",context:{stageName:d,numberOfRecordTypesRendered:g}}}});var g=c.getState(),h=c.getReturnValue();this.toggleSpinner(!1);\"SUCCESS\"===g&&!h.hasErrors&&e?(e(h),a._dependentPicklistTreePanel&&\na._dependentPicklistTreePanel.close(),a._reloadAfterDependencyModalAction&&(a._reloadAfterDependencyModalAction=!1,a.reload(!0)),a._dropEvent=void 0,a._dependentPicklistTreePanel=void 0,a._dependentPicklistTreeCmp=void 0):f&&f(c)});$A.enqueueAction(h)},updateCard:function(a,b,c,d){var e=d.$focusElement$,f=a.get(\"v._totalRecordCount\"),g=a.get(\"v._columnItems\"),h=a.get(\"v._groupByFieldName\"),l=b[h],k=c.sobject[h],h=d.getPipelineColumnData(a,\"apiNames\",l),m=d.getPipelineColumnData(a,\"apiNames\",k),p=\nh?h.colIndex:void 0,s=m?m.colIndex:void 0,q=d.getPipelineColumn(a,h?h.columnId:void 0),r=d.getPipelineColumn(a,m?m.columnId:void 0);l!==k?(h&&q&&h.removeRecord(b,q),r&&!r.isInstanceOf(\"runtime_sales_pipelineboard:pipelineViewCloseLostTarget\")?(b=m.addRecords([c],0,r),m.updateRecord(c,r),d.updateCachedData(a,h,m,c.sobject),e&&(e.colIndex=s,e.cardIndex=b+1)):(a.set(\"v._totalRecordCount\",f--),d.fireEventForObjectHomeStatus(a,f,d.$orderByFieldLabel$),d.rememberFocus(d,null,p,0))):m.updateRecord(c,r);\na.set(\"v._columnItems\",g);d.refreshPipelineViewColumn(a,{columnItems:g,closeLostColumnId:a.get(\"v._closeLostColumnId\"),closeLostMasterLabel:a.get(\"v._closeLostMasterLabel\"),closeLostHasPopup:a.get(\"v._closeLostHasPopup\"),totalRecordCount:a.get(\"v._totalRecordCount\"),groupByField:a.get(\"v._groupByFieldName\"),groupByFieldLabel:a.get(\"v._groupByFieldLabel\"),groupByFieldType:a.get(\"v._groupByFieldType\"),entityLabel:a.get(\"v._entityLabel\"),entityLabelPlural:a.get(\"v._entityLabelPlural\"),aggregateColumnFormat:a.get(\"v._aggregateValueFormat\"),\nlogInfo:a.get(\"v._logInfo\"),fields:a.get(\"v._fields\"),focusElement:e},d)},refreshRecord:function(a,b,c){for(var d=null,e=a.get(\"v._columnItems\"),f=0;f<e.length;f++){var g=e[f].getPipelineDataRecord(b);if(null!=g){d=g;break}}null!=d&&(e=a.get(\"c.refreshRecord\"),e.setParams({record:{Id:b},fields:a.get(\"v._fields\"),recordTypeId:a.get(\"v._recordTypeId\"),listViewId:a.get(\"v.filterName\")}),e.setCallback(this,function(b){\"SUCCESS\"===b.getState()?(b=b.getReturnValue(),c.updateCard(a,d.sobject,b,c)):c.handleActionError(a,\nb)}),$A.enqueueAction(e))},fireEventForObjectHomeStatus:function(a,b,c){var d=a.get(\"v._dataProvider[0]\").get(\"v.lastUpdated\");a=a.getEvent(\"pipelineViewStateChange\");c=null===c?null:[c];a.setParams({recordCount:b,orderedBy:c,filteredBy:\"\",lastUpdated:d}).fire()},updateCachedData:function(a,b,c,d){var e=a.get(\"v._allData\");a=a.get(\"v._recordTypeId\");if((e=e[\"undefined\"==typeof a?null:a])&&d)d=this.getIndexOfRecordInColumn(e,b.apiNames[0],d),a=e.records[b.apiNames[0]][d],e.records[c.apiNames[0]]?e.records[c.apiNames[0]].push(a):\ne.records[c.apiNames[0]]=[a],e.records[b.apiNames[0]].splice(d,1)},showCelebrationIfMatchingAnimationRuleRecordExists:function(a,b,c,d){var e=a.get(\"v._allData\"),f=a.get(\"v._recordTypeId\"),g=a.get(\"v.scope\"),h=a.get(\"v._groupByFieldName\"),f=\"undefined\"==typeof f?null:f;e[f]&&e[f].pathAssistant&&(e=e[f].pathAssistant.animationRule)&&d.animationRuleLib.AnimationRule.showCelebrationIfMatchingAnimationRuleRecordExists(e,a,c.apiNames[0],b.apiNames[0],g,h)},getIndexOfRecordInColumn:function(a,b,c){return a.records[b].map(function(a){return a.sobject.Id}).indexOf(c.Id)},\ncheckDependentPicklistValuesForRequiredness:function(a,b,c){a=c.getDataForCurrentRecordType(a);for(var d in b){c=a.layoutMetadata.dependentPicklistMetadata[d];var e=a.layoutMetadata.requiredFields.hasOwnProperty(d),f=d===a.groupByField,g=b[d],h=$A.util.isEmpty(g);if(!c&&e&&f&&h||c&&!$A.util.isEmpty(a.layoutMetadata.dependentPicklistMetadata[d][g])&&e&&h)return!1}return!0},checkDependenciesAndHandleDrop:function(a,b,c,d,e,f){a._dropEvent=f;var g=c.record;a.set(\"v._recordData\",g);var h=b.getDataForCurrentRecordType(a),\nl=this.dependentPicklistLib.DependentPicklist.isThereValidDependentPicklistValueForProcessField(h.groupByField,e.apiNames[0],h.layoutMetadata),k=a._dependentPicklistTreeCmp,m=\"Task\"===a.get(\"v.scope\");if(l&&!k&&!m){var p=a.get(\"c.refreshRecord\"),l=a.get(\"v._fields\"),l=l.concat(Object.keys(h.layoutMetadata.dependentPicklistMetadata));p.setParams({record:{Id:g.Id},fields:l,recordTypeId:a.get(\"v._recordTypeId\"),listViewId:a.get(\"v.filterName\")});p.setCallback(this,function(k){\"SUCCESS\"===k.getState()&&\n(a._dependentPicklistTreeCmp?b.handleDrop(a,b,c,d,e,f):(k=p.getReturnValue().sobject,g[e.groupByField]=e.apiNames[0],this.dependentPicklistLib.DependentPicklist.removeInvalidValuesForDependentPicklistFields(a,g,k,h.layoutMetadata,h.groupByField,b),b.createDependencyTreeComponent(a,g),b.toggleCloseLostTarget(a,!1)))});$A.enqueueAction(p)}else b.handleDrop(a,b,c,d,e,f)},handleDrop:function(a,b,c,d,e,f){var g=c.record,h=a.get(\"v._columnItems\");try{var l=a.get(\"v._groupByFieldType\"),k=b.shouldUpdateRecord(a,\ng,e,b),m=\"Task\"===a.get(\"v.scope\")&&\"owner\"===l;k&&(\"owner\"!==l||m)?new b.DataTransferTransaction(a,g,d,e,$A.getCallback(function(k){var l=!1;try{l=k.transferData(f,c)}catch(m){if(\"InvalidStateException\"===m){b.displayDragAndDropError();return}throw m;}a.set(\"v._columnItems\",h);$A.dragAndDropService.fireDropComplete(f,!0);b.pipelineLib.FieldsAndGuidance.fireSecondaryDisplayChange(a,void 0,{action:b.pipelineLib.FieldsAndGuidance.panelActions.CANCEL_INLINE_EDIT});if(l){var r=k.targetColumn.indexOf(g.Id),\nn=b.getPipelineColumn(a,k.targetColumn.columnId).getElement(),n=b.getPipelineViewColumnIndex(n);b.rememberFocus(b,null,n,r)}else n=b.getPipelineColumn(a,k.sourceColumn.columnId).getElement(),n=b.getPipelineViewColumnIndex(n),b.rememberFocus(b,null,n,0);k.save(function(c){a.isValid()&&e.isCloseLost()&&b.showCelebrationIfMatchingAnimationRuleRecordExists(a,d,e,b);a.isValid()&&l&&(b.rememberFocus(b,document.activeElement),e.updateRecord(c,b.getPipelineColumn(a,e.columnId)),a.set(\"v._columnItems\",h),\nb.updateCachedData(a,d,e,g),b.showCelebrationIfMatchingAnimationRuleRecordExists(a,d,e,b),window.setTimeout($A.getCallback(function(){var b=a.getEvent(\"onLoadMoreData\");b.setParams({columnName:k.sourceColumn.apiNames[0]});b.fire()}),0))},function(c){if(a.isValid()){a.get(\"v.scope\");var d=b.getPipelineColumn(a,k.sourceColumn.columnId).getElement(),d=b.getPipelineViewColumnIndex(d);b.rememberFocus(b,document.activeElement,d,0);b.displayErrorMessages(a,c,g,b);k.revert();b.displayMessage(a,\"\");a.set(\"v._columnItems\",\na.get(\"v._columnItems\"));b.getPipelineColumn(a,k.targetColumn.columnId).isInstanceOf(\"runtime_sales_pipelineboard:pipelineViewCloseLostTarget\")&&(a.set(\"v._totalRecordCount\",a.get(\"v._totalRecordCount\")+1),b.fireEventForObjectHomeStatus(a,a.get(\"v._totalRecordCount\"),b.$orderByFieldLabel$));b.handleActionError(a,c)}})})):\"owner\"===l&&!m?new b.DataTransferTransaction(a,g,d,e,$A.getCallback(function(k){var l=!1;try{l=k.transferData(f,c)}catch(m){if(\"InvalidStateException\"===m){b.displayDragAndDropError();\nreturn}throw m;}a.set(\"v._columnItems\",h);$A.dragAndDropService.fireDropComplete(f,!0);if(l){var r=k.targetColumn.indexOf(g.Id),n=b.getPipelineColumn(a,k.targetColumn.columnId).getElement(),u=b.getPipelineViewColumnIndex(n);b.rememberFocus(b,null,u,r)}else n=b.getPipelineColumn(a,k.sourceColumn.columnId).getElement(),u=b.getPipelineViewColumnIndex(n),b.rememberFocus(b,null,u,0);var t={};t.displayName=e.masterLabel;t.id=e.apiNames[0];b.showOwnerChangeModal(a,g,t,$A.getCallback(function(c){k.revert();\nb.displayMessage(a,\"\");r=k.sourceColumn.indexOf(g.Id);n=b.getPipelineColumn(a,k.sourceColumn.columnId).getElement();u=b.getPipelineViewColumnIndex(n);b.rememberFocus(b,null,u,r);a.set(\"v._columnItems\",a.get(\"v._columnItems\"));b.getPipelineColumn(a,k.targetColumn.columnId).isInstanceOf(\"runtime_sales_pipelineboard:pipelineViewCloseLostTarget\")&&(a.set(\"v._totalRecordCount\",a.get(\"v._totalRecordCount\")+1),b.fireEventForObjectHomeStatus(a,a.get(\"v._totalRecordCount\"),b.$orderByFieldLabel$))}),$A.getCallback(function(c){c=\na.get(\"v._allData\");var f=a.get(\"v._recordTypeId\");if((c=c[\"undefined\"==typeof f?null:f])&&g)f=b.getIndexOfRecordInColumn(c,d.apiNames[0],g),c=c.records[d.apiNames[0]][f],c.sobject.Owner.Id=t.id,c.sobject.Owner.Name=t.displayName,e.updateRecord(c,b.getPipelineColumn(a,e.columnId)),b.updateCachedData(a,d,e,g);r=k.targetColumn.indexOf(g.Id);n=b.getPipelineColumn(a,k.targetColumn.columnId).getElement();u=b.getPipelineViewColumnIndex(n);b.rememberFocus(b,null,u,r);a.set(\"v._columnItems\",a.get(\"v._columnItems\"))}))})):\n$A.dragAndDropService.fireDropComplete(f,!0)}finally{b.finishDrop(a,f,b,g.Id)}},finishDrop:function(a,b,c,d){c.toggleCloseLostTarget(a,!1);a=a.find(\"dndAccessibilityComponent\").find(\"menuList\").getElement();0<=a.className.indexOf(\"visible\")&&$A.util.removeClass(a,\" visible\");c.removeDropTarget(b.getParams())},showOwnerChangeModal:function(a,b,c,d,e){a.set(\"v.changeOwnerWasClicked\",!1);$A.createComponent(\"markup://force:changeOwnerContent\",{record:b,newOwner:c,refreshAfterOwnerChanged:!1},$A.getCallback(function(b,\nc,h){\"SUCCESS\"===c?$A.getEvt(\"markup://ui:createPanel\").setParams({panelType:\"actionModal\",visible:!0,panelConfig:{title:$A.get(\"$Label.SFX_OwnerChangeCmp.transfer_title\"),body:b,closeOnActionButtonClick:!1,bodyClass:\"slds-p-around--none\"},onDestroy:function(){null===a.get(\"v.changeOwnerPanel\")||!a.get(\"v.changeOwnerWasClicked\")?d():a.get(\"v.changeOwnerWasClicked\")&&e()},onCreate:function(b){a.set(\"v.changeOwnerPanel\",b);$A.createComponents([[\"ui:button\",{label:$A.get(\"{!$Label.Buttons.cancel}\"),\nbuttonTitle:$A.get(\"{!$Label.Buttons.cancel}\")}],[\"ui:button\",{\"aura:flavor\":\"default, brand\",label:$A.get(\"{!$Label.SFX_OwnerChangeCmp.transfer_title}\"),buttonTitle:$A.get(\"{!$Label.SFX_OwnerChangeCmp.transfer_title}\"),variant:\"slds-button slds-button--brand\"}]],function(c){c[0].addHandler(\"press\",a,\"c.handleModalCancelPress\");c[1].addHandler(\"press\",a,\"c.handleChangeOwnerPress\");b.set(\"v.footer\",c)})}}).fire():\"ERROR\"===c&&this.componentLib.actions.showCreateComponentError(a.getDef().getDescriptor().getQualifiedName(),\n[\"markup://force:changeOwnerContent\"])}.bind(this)))},toggleSpinner:function(a){$A.getEvt(\"markup://force:toggleModalSpinner\")&&$A.getEvt(\"markup://force:toggleModalSpinner\").setParams({isVisible:a}).fire()},getLoggingPayload:function(a,b,c){return{context:{injectPageUsageInfo:!0,usageInfo:{action:b,gusTeamId:\"a00B0000000w8AM\",location:\"runtime_sales_pipelineboard:pipelineViewHome\",sobjectType:a,target:c}}}},logTransactionEnd:function(a,b){var c=a.get(\"v._logInfo\");if(!$A.util.isUndefinedOrNull(c)){var d=\nthis.getLoggingPayload(a.get(\"v.scope\"),\"Load\",\"runtime_sales_pipelineboard:pipelineView:onLoad\");d.context.filterName=a.get(\"v.filterName\");var e=a.get(\"v._recordTypeId\");$A.util.isUndefinedOrNull(e)||(d.context.usageInfo.recordTypeId=e);d.context.usageInfo.num=a.get(\"v._totalRecordCount\");d.context.usageInfo.otherNum=c.stageCount;d.context.alertCount=c.alertCount;d.context.success=b}},getDirectionOfModal:function(a){var b=\"east\";a.getBoundingClientRect().left>2*window.innerWidth/3&&(b=\"west\");return b},\ngetFunctionToHandleScroll:function(a,b){return function(c){this.scrollLeft+this.offsetWidth>=this.scrollWidth-70&&a.helper.renderView(a,!0,!1,!0,!1,null,b);(c=a.find(\"userAssistancePopoversManager\"))&&c.isTherePopup()&&c.destroyPopover()}},getFunctionToHandleWindowResize:function(a,b){return function(c){a.helper.renderView(a,!0,!1,!0,!1,null,b)}},getFunctionToHandleSpace:function(a,b){return function(c){32==c.keyCode&&(0<=c.target.className.indexOf(\"showActionsButton\")?(c.preventDefault(),c.target.click()):\n0<=c.target.className.indexOf(\"outputLookupLink\")||0<=c.target.className.indexOf(\"alertIcon\")?c.preventDefault():0<=c.target.className.indexOf(\"pipelineViewCard\")&&c.target.draggable&&(b.renderView(a,!0,!1,!0,!0,null,b),window.setTimeout($A.getCallback(function(){if(a.find(\"dndAccessibilityComponent\")&&a.find(\"dndAccessibilityComponent\").find(\"menuList\")&&a.find(\"dndAccessibilityComponent\").find(\"menuList\").getElement()){var b=a.find(\"dndAccessibilityComponent\").find(\"menuList\").getElement();if(0<=\nb.className.indexOf(\"visible\")){var c=document.activeElement;c&&-1!==c.className.indexOf(\"pipelineViewCard\")&&(b=b.querySelector(\".uiMenuItem a\"))&&b.focus()}}},0))))}},getFunctionToHandleTab:function(a,b){return function(b){if(9===b.keyCode){var d=a.find(\"dndAccessibilityComponent\").find(\"menuList\").getElement();0<=d.className.indexOf(\"visible\")&&(b.preventDefault(),$A.util.removeClass(d,\"visible\"))}}},handleCardToGuidance:function(a,b){return function(a){if(117===a.keyCode&&(a.ctrlKey||a.metaKey)&&\n!a.shiftKey){a.preventDefault();a.stopPropagation();var b=document.getElementsByClassName(\"pipelineViewSidePanelHeader\");null!=b&&0<b.length&&(a=document.getElementsByTagName(\"force-list-view-manager-button-bar\"),0<a.length&&(a=a[0].getElementsByClassName(\"fieldsAndGuidanceButton\"),0<a.length&&document.getElementsByClassName(\"runtime_sales_pipelineboardPipelineViewSidePanel\")[0].classList.contains(\"slds-hide\")&&(a[0].click(),window.requestAnimationFrame(function f(){b=document.getElementsByClassName(\"pipelineViewSidePanelHeader\");\n0<b.length?b[0].focus():window.requestAnimationFrame(f)}))),b[0].focus())}}},getFunctionToHandleArrowKeyboardShortcuts:function(a,b){return function(c){if(0<=a.find(\"dndAccessibilityComponent\").find(\"menuList\").getElement().className.indexOf(\"visible\"))(40===c.keyCode||38===c.keyCode)&&-1!==document.activeElement.className.indexOf(\"pipelineViewCard\")&&a.find(\"dndAccessibilityComponent\").find(\"menuList\").getElement().querySelector(\".uiMenuItem a\").focus();else if(0<=c.target.className.indexOf(\"showActionsButton\")&&\n(40===c.keyCode||38===c.keyCode))c.target.click();else if(37<=c.keyCode&&40>=c.keyCode&&0<=c.target.className.indexOf(\"pipelineViewCard\")&&0<=c.target.className.indexOf(\"uiDraggable\")){var d=40===c.keyCode||39===c.keyCode,e=b.pipelineLib.Dom.getParent(c.target,\"li\"),f=b.pipelineLib.Dom.getParent(e,\"ul\"),g=b.pipelineLib.Dom.getParent(f,\".pipelineColumn.runtime_sales_pipelineboardPipelineViewColumn\"),h=b.pipelineLib.Dom.getParent(g,\".container\"),l=function(a){var b=null,b=d?e.nextElementSibling:e.previousElementSibling;\na&&!b&&(b=d?f.firstChild:f.lastChild);return b?b.querySelector(\".pipelineViewCard.uiDraggable\"):null},k=37===c.keyCode||39===c.keyCode?null:l(!0);for(c=d?g.nextElementSibling:g.previousElementSibling;null==k;){if(null!=c){l=c.querySelectorAll(\".pipelineViewCard.uiDraggable\");if(0<l.length){k=l[0];break}c=d?c.nextElementSibling:c.previousElementSibling}else if(c=d?h.firstChild:h.lastChild,void 0===c.className||\"pipelineColumn runtime_sales_pipelineboardPipelineViewColumn\"!==c.className)c=d?c.nextElementSibling:\nc.previousElementSibling;if(c===g)break}k&&e!==k&&a.getEvent(\"confirmIfEdited\").setParams({refreshDisplay:!0,title:$A.get(\"$Label.PipelineViewSidePanel.inlineEditLeaveMessage_Title\"),bodyMessage:$A.get(\"$Label.PipelineViewSidePanel.inlineEditLeaveMessage_BodyMessage\"),confirmationMessage:$A.get(\"$Label.PipelineViewSidePanel.inlineEditLeaveMessage_ConfirmationMessage\"),continueCallback:$A.getCallback(function(){b.rememberFocus(b,k,-1,-1);var c=b.$focusElement$.recordId;null!=c&&b._handleCardSelection(a,\nb,c);b.focusElement(a,b)}),cancelCallback:$A.getCallback(function(){}),stayLabel:$A.get(\"$Label.PipelineViewSidePanel.inlineEditLeaveMessage_StayButton\"),leaveLabel:$A.get(\"$Label.PipelineViewSidePanel.inlineEditLeaveMessage_LeaveButton\")}).fire()}}},handleCardSelection:function(a,b,c){b._handleCardSelection(a,b,c.payload.recordId)},_handleCardSelection:function(a,b,c){b._updateCardsStyle(a,b,c);var d=b.getPipelineColumnDataOfCard(a,c);$A.util.isUndefinedOrNull(d)?b.$focusElement$=null:(c=b.getKeyFieldsAndGuidancePayload(a,\nb,d,c),b.pipelineLib.FieldsAndGuidance.fireSecondaryDisplayChange(a,void 0,c))},_updateCardsStyle:function(a,b,c){a=a.getElement().querySelectorAll(\".\"+b.$selectedCardClass$);if(0<a.length)for(var d=0;d<a.length;d++)$A.util.removeClass(a[d],b.$selectedCardClass$);c=document.getElementsByClassName(c)[0];null!=c&&($A.util.addClass(c,b.$selectedCardClass$),b.rememberFocus(b,c))},getKeyFieldsAndGuidancePayload:function(a,b,c,d){return{action:b.getKeyFieldAndGuidancePanelAction(a,b,c.pathAvailability),\nrecordId:d,entityName:a.get(\"v.scope\"),entityLabel:a.get(\"v._entityLabel\"),compactLayoutFields:b.getCompactLayoutFieldsForCurrentRecordType(a,b),columnName:c.apiNames[0],groubByField:c.groupByField,hasKeyFields:0<c.keyFields.length,guidance:c.guidance}},getKeyFieldAndGuidancePanelAction:function(a,b,c){return a.get(\"v._isPathAssistantMetadataLoading\")?b.pipelineLib.FieldsAndGuidance.panelActions.SET_RECORD_LOADING:c?b.pipelineLib.FieldsAndGuidance.panelActions.SET_RECORD_AND_PATH:b.pipelineLib.FieldsAndGuidance.panelActions.SET_RECORD_ONLY}},\nrenderer:{render:function(a,b){return a.superRender()},rerender:function(a,b){a.superRerender();for(var c=a.getElement().querySelectorAll(\"a, img\"),d=0;d<c.length;d++)(!c[d].hasAttribute(\"draggable\")||$A.util.getBooleanValue(c[d].getAttribute(\"draggable\")))&&c[d].setAttribute(\"draggable\",\"false\");b.disableDnDOnPipelineCardsInTransaction(b);b.resizePipelineColumnHeaders(a);b.focusElement(a,b)},afterRender:function(a,b){a.superAfterRender();if(a.isValid()&&!$A.util.isUndefinedOrNull(a.getElement())){var c=\n$A.getCallback(b.getFunctionToHandleArrowKeyboardShortcuts(a,b));a.find(\"pipelineViewMain\").getElement().addEventListener(\"keyup\",c);c=$A.getCallback(b.getFunctionToHandleSpace(a,b));a.find(\"pipelineViewMain\").getElement().addEventListener(\"keydown\",c);c=$A.getCallback(b.getFunctionToHandleTab(a,b));a.find(\"pipelineViewMain\").getElement().addEventListener(\"keydown\",c);c=$A.getCallback(b.getFunctionToHandleScroll(a,b));a.find(\"pipelineViewMain\").getElement().addEventListener(\"scroll\",c);c=$A.getCallback(b.handleCardToGuidance(a,\nb));a.find(\"pipelineViewMain\").getElement().addEventListener(\"keydown\",c);c=$A.getCallback(b.getFunctionToHandleWindowResize(a,b));window.addEventListener(\"resize\",c)}}}}});","uuid":null}"createdN P
,DwB"expiresN PÄDwB"valueEncodedF{"sizeI¼¼"expiresN PÄDwB{